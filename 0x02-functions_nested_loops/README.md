this is the functions and nested loops code
